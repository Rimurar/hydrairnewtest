<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hydrair</title>
    <style>
        body {
            padding: 20px;
        }
        h1 {
            color: #00FFFF;
            text-align: center;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .weekday-item {
            margin-bottom: 10px;
        }
        .total-drink {
            margin-top: 20px;
            font-weight: bold;
        }
        .manual-input-label {
            margin-bottom: 5px;
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hydrair</h1>

        <h3>So viel haben Sie getrunken:</h3>
        <ul id="weekdayList">
            <!-- Placeholder for weekdays -->
        </ul>

        <label for="manualInput" class="manual-input-label">Hier zus채tzliche Getr채nke in [ml] eingeben:</label>
        <div class="manual-input">
            <input type="number" id="manualInput" name="manualInput" min="0" step="any">
            <button onclick="addManualInput()">Hinzuf체gen</button>
        </div>

        <h2>Ihr CO2 Wert liegt bei:</h2>
        <p id="co2Snapshot">N/A ppm</p>
    </div>

    <script>
        // Function to fetch data from server
        function fetchData() {
            fetch('/Hydrair/data.json') // Replace with your server endpoint
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Fetched data:', data);
                    updateData(data);
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        // Function to update HTML elements with fetched data
        function updateData(data) {
            const weekdays = ['Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag', 'Sonntag'];
            const weekdayList = document.getElementById('weekdayList');
            weekdayList.innerHTML = ''; // Clear existing list items
            const currentDayIndex = (new Date().getDay() + 6) % 7; // Adjust index for German week starting with Monday

            weekdays.forEach((day, index) => {
                const li = document.createElement('li');
                const weightText = data[day.toLowerCase()] ? data[day.toLowerCase()] + ' ml' : 'N/A';
                li.textContent = day + ': ' + weightText;
                li.classList.add('weekday-item');
                if (index === currentDayIndex) {
                    li.setAttribute('id', 'today');
                }
                weekdayList.appendChild(li);
            });

            // Update CO2 snapshot
            document.getElementById('co2Snapshot').textContent = data.co2 || 'N/A ppm';
        }

        // Function to add manual input to the current day
        function addManualInput() {
            const input = document.getElementById('manualInput');
            const value = parseFloat(input.value);
            if (!isNaN(value)) {
                const todayItem = document.getElementById('today');
                const day = todayItem.textContent.split(':')[0].trim();
                const currentWeightText = todayItem.textContent.split(':')[1].trim();
                const currentWeight = parseFloat(currentWeightText.split(' ')[0]);
                if (!isNaN(currentWeight)) {
                    const newValue = currentWeight + value;
                    todayItem.textContent = day + ': ' + newValue.toFixed(1) + ' ml';
                } else {
                    todayItem.textContent = day + ': ' + value.toFixed(1) + ' ml';
                }
                input.value = ''; // Clear input field after adding
            } else {
                alert('Bitte geben Sie eine g체ltige Zahl ein.');
            }
        }

        // Initial data fetch when page loads
        document.addEventListener('DOMContentLoaded', fetchData);
    </script>
</body>
</html>